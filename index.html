<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>Lotus ¬∑ Admin MVP</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="icon" href="data:,">
<style>
  body{font-family:system-ui;background:#0b0b14;color:#fff;padding:20px}
  h2{margin:0 0 8px}
  .muted{opacity:.75}
  .card{background:#141428;padding:16px;border-radius:12px;margin-bottom:16px}
  input,select,button{padding:10px;border-radius:8px;border:none}
  input,select{min-width:240px}
  button{background:#6c5cff;color:#fff;font-weight:700;cursor:pointer}
  button.secondary{background:#2a2a44}
  button.danger{background:#ff4d4d}
  .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  pre{white-space:pre-wrap;word-break:break-word;background:#0f0f1f;padding:10px;border-radius:10px}
  .pill{display:inline-block;padding:4px 10px;border-radius:999px;background:#22223b;font-size:12px}
  .pill.ok{background:#1f3a2b}
  .pill.draft{background:#3a2a1f}
  .grid{display:grid;grid-template-columns:1fr;gap:12px}
  @media (min-width: 980px){
    .grid{grid-template-columns:1fr 1fr}
  }
  table{width:100%;border-collapse:collapse;margin-top:8px}
  th,td{border-bottom:1px solid #2b2b44;padding:8px;text-align:left;font-size:13px;vertical-align:top}
  th{opacity:.8;font-weight:700}
  .small{font-size:12px}
  .mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
</style>
</head>
<body>

<h2>Lotus ¬∑ Admin MVP</h2>
<div class="muted" style="margin-bottom:16px">
  Backend: GitHub Pages ‚Üí Yandex Function ‚Üí GAS ‚Üí Google Sheets
</div>

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<script>
/** ===============================
 *  CONFIG (–∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π endpoint)
 *  =============================== */
const API_URL = "https://functions.yandexcloud.net/d4evbekf5us7hbjid3m3";

/** ---------- Utilities ---------- */
const $ = (id) => document.getElementById(id);
function esc_(s){ return String(s ?? '').replace(/[&<>"']/g, m=>({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;" }[m])); }

async function api(action, data){
  if (!API_URL || API_URL.includes('PASTE_')) throw new Error('–ù–µ –∑–∞–¥–∞–Ω API_URL (endpoint Yandex Function).');
  const res = await fetch(API_URL, {
    method: "POST",
    headers: { "Content-Type":"application/json" },
    body: JSON.stringify({ action, data })
  });
  const json = await res.json().catch(()=>null);
  if (!json) throw new Error('–û—Ç–≤–µ—Ç –Ω–µ JSON (–ø—Ä–æ–≤–µ—Ä—å Yandex Function)');
  if (!json.ok) throw new Error(json.error || 'Unknown API error');
  return json.data;
}

function readExcelFirstSheet(file){
  return new Promise((resolve, reject) => {
    if (!file) return reject(new Error('–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω'));
    const r = new FileReader();
    r.onload = e => {
      try {
        const wb = XLSX.read(e.target.result, { type:'binary' });
        const ws = wb.Sheets[wb.SheetNames[0]];
        const rows = XLSX.utils.sheet_to_json(ws, { header: 1, blankrows: false });
        resolve(rows);
      } catch (err){ reject(err); }
    };
    r.onerror = reject;
    r.readAsBinaryString(file);
  });
}

/** ---------- State ---------- */
const state = {
  releasesHeader: [],
  releasesRows: [],
  communitiesHeader: [],
  communitiesRows: [],
  selectedReleaseId: ""
};

function idx_(header, name){ return header.indexOf(name); }
function getReleaseById_(id){
  const ridx = idx_(state.releasesHeader,'release_id');
  return state.releasesRows.find(r => String(r[ridx]) === String(id)) || null;
}
function getCommunitiesForRelease_(release_id){
  const ridx = idx_(state.communitiesHeader,'release_id');
  const cid = idx_(state.communitiesHeader,'community_id');
  const cname = idx_(state.communitiesHeader,'community_name');
  const sidx = idx_(state.communitiesHeader,'sort_order');
  return state.communitiesRows
    .filter(r => String(r[ridx]) === String(release_id))
    .map(r => ({
      community_id: String(r[cid] ?? ''),
      community_name: String(r[cname] ?? ''),
      sort_order: Number(r[sidx] ?? 0)
    }))
    .sort((a,b)=>a.sort_order-b.sort_order);
}

function setStatus(text, isErr=false){
  const el = $('global-status');
  el.textContent = text;
  el.style.opacity = "1";
  el.style.color = isErr ? "#ff9d9d" : "#b9ffcf";
  setTimeout(()=>{ el.style.opacity="0.75"; }, 1500);
}

/** ---------- Rendering ---------- */
function renderReleaseSelect(){
  const ridx = idx_(state.releasesHeader,'release_id');
  const titleIdx = idx_(state.releasesHeader,'title');
  const pubIdx = idx_(state.releasesHeader,'published');
  const slugIdx = idx_(state.releasesHeader,'login_slug');

  const options = state.releasesRows.map(r=>{
    const id = String(r[ridx] ?? '');
    const title = String(r[titleIdx] ?? '');
    const slug = String(r[slugIdx] ?? '');
    const pub = (r[pubIdx] === true || String(r[pubIdx]).toLowerCase() === 'true');
    const mark = pub ? 'üü¢' : 'üü°';
    return `<option value="${esc_(id)}">${mark} ${esc_(title)} (${esc_(slug)})</option>`;
  }).join('');

  $('release-select').innerHTML = `<option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å —Ä–µ–ª–∏–∑ ‚Äî</option>` + options;
  $('release-select').value = state.selectedReleaseId || "";
}

function renderSelectedRelease(){
  const rel = state.selectedReleaseId ? getReleaseById_(state.selectedReleaseId) : null;
  if (!rel){
    $('selected-release').innerHTML = `<div class="muted">–†–µ–ª–∏–∑ –Ω–µ –≤—ã–±—Ä–∞–Ω</div>`;
    $('community-release-id').value = "";
    $('vk-release').value = "";
    $('dg-release').value = "";
    $('s-release').value = "";
    $('community-list').innerHTML = '';
    return;
  }

  const h = state.releasesHeader;
  const title = rel[idx_(h,'title')];
  const slug = rel[idx_(h,'login_slug')];
  const publishedRaw = rel[idx_(h,'published')];
  const published = (publishedRaw === true || String(publishedRaw).toLowerCase() === 'true');
  const rid = rel[idx_(h,'release_id')];
  const pass = rel[idx_(h,'password')];
  const artist = rel[idx_(h,'artist_name')];
  const track = rel[idx_(h,'track_title')];
  const ps = rel[idx_(h,'period_start')];
  const pe = rel[idx_(h,'period_end')];

  $('community-release-id').value = rid;
  $('vk-release').value = rid;
  $('dg-release').value = rid;
  $('s-release').value = rid;

  $('selected-release').innerHTML = `
    <div class="row" style="justify-content:space-between">
      <div>
        <div><b>${esc_(title)}</b></div>
        <div class="small muted">
          <span class="mono">${esc_(rid)}</span>
          ¬∑ slug: <span class="mono">${esc_(slug)}</span>
          ¬∑ –ø–∞—Ä–æ–ª—å: <span class="mono">${esc_(pass)}</span>
        </div>
        <div class="small muted">${esc_(artist)} ‚Äî ${esc_(track)} ¬∑ ${esc_(ps)} ‚Äî ${esc_(pe)}</div>
      </div>
      <div>
        <span class="pill ${published ? 'ok' : 'draft'}">${published ? '–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ' : '–ß–µ—Ä–Ω–æ–≤–∏–∫'}</span>
      </div>
    </div>
  `;

  $('btn-publish').textContent = published ? '–°–Ω—è—Ç—å —Å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏' : '–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å';
  $('btn-publish').className = published ? 'danger' : '';
  $('btn-publish').disabled = false;

  renderCommunityList();
}

function renderCommunityList(){
  const relId = state.selectedReleaseId;
  const list = getCommunitiesForRelease_(relId);
  if (!list.length){
    $('community-list').innerHTML = `<div class="muted small">–°–æ–æ–±—â–µ—Å—Ç–≤–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã</div>`;
    return;
  }
  const rows = list.map((c,i)=>`
    <tr>
      <td class="mono">${esc_(c.community_id)}</td>
      <td>${esc_(c.community_name)}</td>
      <td class="small muted">${esc_(c.sort_order)}</td>
      <td>
        <button class="secondary" type="button" onclick="selectCommunity('${esc_(c.community_id)}')">–í—ã–±—Ä–∞—Ç—å –¥–ª—è –∑–∞–≥—Ä—É–∑–æ–∫</button>
      </td>
    </tr>
  `).join('');

  $('community-list').innerHTML = `
    <table>
      <thead><tr>
        <th>community_id</th><th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>sort</th><th>–î–µ–π—Å—Ç–≤–∏–µ</th>
      </tr></thead>
      <tbody>${rows}</tbody>
    </table>
  `;
}

function selectCommunity(cid){
  $('vk-community').value = cid;
  $('dg-community').value = cid;
  setStatus('–í—ã–±—Ä–∞–Ω–æ community_id –¥–ª—è –∑–∞–≥—Ä—É–∑–æ–∫: ' + cid);
}

/** ---------- Data load ---------- */
async function refresh(){
  $('btn-refresh').disabled = true;
  try{
    const data = await api('bootstrapAdmin', {});
    // GAS –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤—ã rows (–±–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –≤ —Ä—è–¥) ‚Äî –º—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∫ –µ—Å—Ç—å
    state.releasesHeader = data.releasesHeader || [];
    state.releasesRows = data.releases || [];
    state.communitiesHeader = data.communitiesHeader || [];
    state.communitiesRows = data.communities || [];

    renderReleaseSelect();
    renderSelectedRelease();
    setStatus('–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã');
  }catch(e){
    setStatus('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: ' + e.message, true);
  }finally{
    $('btn-refresh').disabled = false;
  }
}

/** ---------- Actions ---------- */
async function createRelease(){
  try{
    const title = $('r-title').value.trim();
    const password = $('r-password').value.trim();
    if (!title) throw new Error('–£–∫–∞–∂–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–ª–∏–∑–∞');
    if (!password) throw new Error('–£–∫–∞–∂–∏ –ø–∞—Ä–æ–ª—å –∞—Ä—Ç–∏—Å—Ç–∞');

    const data = await api('createRelease', { title, password });
    $('r-out').textContent = JSON.stringify(data, null, 2);

    await refresh();
    state.selectedReleaseId = data.release_id;
    renderReleaseSelect();
    renderSelectedRelease();
    setStatus('–†–µ–ª–∏–∑ —Å–æ–∑–¥–∞–Ω');
  }catch(e){
    $('r-out').textContent = '–û—à–∏–±–∫–∞: ' + e.message;
    setStatus('–û—à–∏–±–∫–∞: ' + e.message, true);
  }
}

async function onSelectRelease(){
  state.selectedReleaseId = $('release-select').value || "";
  renderSelectedRelease();
}

async function addCommunity(){
  try{
    const release_id = $('community-release-id').value.trim();
    if (!release_id) throw new Error('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏ —Ä–µ–ª–∏–∑');

    const community_id = $('c-id').value.trim();
    const community_name = $('c-name').value.trim();
    if (!community_id || !community_name) throw new Error('–£–∫–∞–∂–∏ community_id –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ');

    const existing = getCommunitiesForRelease_(release_id).some(c => c.community_id === community_id);
    if (existing) throw new Error('–¢–∞–∫–æ–π community_id —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω –∫ —Ä–µ–ª–∏–∑—É');

    await api('addCommunity', { release_id, community_id, community_name, sort_order: getCommunitiesForRelease_(release_id).length + 1 });

    $('c-id').value = '';
    $('c-name').value = '';

    await refresh();
    state.selectedReleaseId = release_id;
    renderSelectedRelease();
    setStatus('–°–æ–æ–±—â–µ—Å—Ç–≤–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ');
  }catch(e){
    setStatus('–û—à–∏–±–∫–∞: ' + e.message, true);
  }
}

async function togglePublish(){
  try{
    const release_id = state.selectedReleaseId;
    if (!release_id) throw new Error('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏ —Ä–µ–ª–∏–∑');

    const rel = getReleaseById_(release_id);
    const publishedRaw = rel[idx_(state.releasesHeader,'published')];
    const published = (publishedRaw === true || String(publishedRaw).toLowerCase() === 'true');

    await api('publishRelease', { release_id, published: !published });

    await refresh();
    state.selectedReleaseId = release_id;
    renderSelectedRelease();
    setStatus(!published ? '–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ' : '–°–Ω—è—Ç–æ —Å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏');
  }catch(e){
    setStatus('–û—à–∏–±–∫–∞: ' + e.message, true);
  }
}

/** ---------- Uploads ---------- */
async function uploadVk(){
  try{
    const kind = $('vk-kind').value;
    const release_id = $('vk-release').value.trim();
    const community_id = $('vk-community').value.trim();
    const file = $('vk-file').files[0];

    if (!release_id) throw new Error('–ù–µ—Ç release_id (–≤—ã–±–µ—Ä–∏ —Ä–µ–ª–∏–∑)');
    if (!community_id) throw new Error('–£–∫–∞–∂–∏ community_id (–∫–Ω–æ–ø–∫–∞ "–í—ã–±—Ä–∞—Ç—å –¥–ª—è –∑–∞–≥—Ä—É–∑–æ–∫" –≤ —Å–ø–∏—Å–∫–µ —Å–æ–æ–±—â–µ—Å—Ç–≤)');
    if (!file) throw new Error('–í—ã–±–µ—Ä–∏ —Ñ–∞–π–ª');

    const rows = await readExcelFirstSheet(file);
    const header = rows.shift();
    const dataRows = rows.filter(r => r && r.length && r.some(v => String(v ?? '').trim() !== ''));

    const resp = await api('uploadVkTable', { kind, release_id, community_id, header, rows: dataRows });
    $('vk-out').textContent = JSON.stringify(resp, null, 2);
    setStatus('VK ' + kind + ': –∑–∞–≥—Ä—É–∂–µ–Ω–æ ' + (resp.added ?? 0) + ' —Å—Ç—Ä–æ–∫');
  }catch(e){
    $('vk-out').textContent = '–û—à–∏–±–∫–∞: ' + e.message;
    setStatus('–û—à–∏–±–∫–∞: ' + e.message, true);
  }
}

async function uploadDemoGeo(){
  try{
    const kind = $('dg-kind').value;
    const release_id = $('dg-release').value.trim();
    const community_id = $('dg-community').value.trim();
    const file = $('dg-file').files[0];

    if (!release_id) throw new Error('–ù–µ—Ç release_id (–≤—ã–±–µ—Ä–∏ —Ä–µ–ª–∏–∑)');
    if (!community_id) throw new Error('–£–∫–∞–∂–∏ community_id (–∫–Ω–æ–ø–∫–∞ "–í—ã–±—Ä–∞—Ç—å –¥–ª—è –∑–∞–≥—Ä—É–∑–æ–∫" –≤ —Å–ø–∏—Å–∫–µ —Å–æ–æ–±—â–µ—Å—Ç–≤)');
    if (!file) throw new Error('–í—ã–±–µ—Ä–∏ —Ñ–∞–π–ª');

    const all = await readExcelFirstSheet(file);
    const meta = all.slice(0,5);
    const header = all[5];
    const rows = all.slice(6).filter(r => r && r.length && r.some(v => String(v ?? '').trim() !== ''));

    const campaign_id = String((meta[0] && meta[0][1]) || '').trim();
    const campaign_name = String((meta[1] && meta[1][1]) || '').trim();
    const period_from = String((meta[3] && meta[3][1]) || '').trim();
    const period_to = String((meta[4] && meta[4][1]) || '').trim();

    const resp = await api('uploadDemoGeoTable', {
      kind, release_id, community_id,
      campaign_id, campaign_name, period_from, period_to,
      header, rows
    });
    $('dg-out').textContent = JSON.stringify(resp, null, 2);
    setStatus(kind + ': –∑–∞–≥—Ä—É–∂–µ–Ω–æ ' + (resp.added ?? 0) + ' —Å—Ç—Ä–æ–∫');
  }catch(e){
    $('dg-out').textContent = '–û—à–∏–±–∫–∞: ' + e.message;
    setStatus('–û—à–∏–±–∫–∞: ' + e.message, true);
  }
}

async function uploadStreams(){
  try{
    const release_id = $('s-release').value.trim();
    const file = $('s-file').files[0];

    if (!release_id) throw new Error('–ù–µ—Ç release_id (–≤—ã–±–µ—Ä–∏ —Ä–µ–ª–∏–∑)');
    if (!file) throw new Error('–í—ã–±–µ—Ä–∏ —Ñ–∞–π–ª');

    const rows = await readExcelFirstSheet(file);
    const first = rows[0] || [];
    const looksHeader = String(first[0] || '').toLowerCase().includes('–¥–∞—Ç–∞') || String(first[0] || '').toLowerCase().includes('date');
    if (looksHeader) rows.shift();

    const header = ["date","streams_ok","streams_vk","streams_yandex"];
    const dataRows = rows
      .filter(r => r && r.length && r.some(v => String(v ?? '').trim() !== ''))
      .map(r => [r[0] ?? '', r[1] ?? '', r[2] ?? '', r[3] ?? '']);

    const resp = await api('uploadStreams', { release_id, header, rows: dataRows });
    $('s-out').textContent = JSON.stringify(resp, null, 2);
    setStatus('–°—Ç—Ä–∏–º—ã: –∑–∞–≥—Ä—É–∂–µ–Ω–æ ' + (resp.added ?? 0) + ' —Å—Ç—Ä–æ–∫');
  }catch(e){
    $('s-out').textContent = '–û—à–∏–±–∫–∞: ' + e.message;
    setStatus('–û—à–∏–±–∫–∞: ' + e.message, true);
  }
}
</script>

<div class="grid">

  <div class="card">
    <div class="row" style="justify-content:space-between">
      <h3 style="margin:0">A) –†–µ–ª–∏–∑—ã</h3>
      <button id="btn-refresh" class="secondary" type="button">–û–±–Ω–æ–≤–∏—Ç—å</button>
    </div>

    <div class="row" style="margin-top:10px">
      <select id="release-select"></select>
      <button id="btn-publish" type="button" disabled>–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
    </div>

    <div style="margin-top:10px" id="selected-release"></div>
    <div class="muted small" id="global-status" style="margin-top:10px;opacity:.75">‚Äî</div>
  </div>

  <div class="card">
    <h3 style="margin-top:0">B) –°–æ–∑–¥–∞—Ç—å —Ä–µ–ª–∏–∑</h3>
    <div class="row">
      <input id="r-title" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–ª–∏–∑–∞" />
      <input id="r-password" placeholder="–ü–∞—Ä–æ–ª—å –∞—Ä—Ç–∏—Å—Ç–∞" />
      <button id="btn-create-release" type="button">–°–æ–∑–¥–∞—Ç—å</button>
    </div>
    <pre id="r-out">‚Äî</pre>
    <div class="muted small">
      –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–ª–∏–∑ –ø–æ—è–≤–∏—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ. –õ–æ–≥–∏–Ω (slug) –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
    </div>
  </div>

</div>

<div class="card">
  <h3 style="margin-top:0">C) –°–æ–æ–±—â–µ—Å—Ç–≤–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–ª–∏–∑–∞</h3>
  <div class="row">
    <input id="community-release-id" placeholder="release_id (–∞–≤—Ç–æ)" readonly />
    <input id="c-id" placeholder="community_id" />
    <input id="c-name" placeholder="community_name" />
    <button id="btn-add-community" type="button">–î–æ–±–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ</button>
  </div>
  <div id="community-list"></div>
</div>

<div class="grid">
  <div class="card">
    <h3 style="margin-top:0">D) –ó–∞–≥—Ä—É–∑–∫–∞ VK —Ç–∞–±–ª–∏—Ü</h3>
    <div class="row">
      <select id="vk-kind">
        <option value="campaigns">–ö–∞–º–ø–∞–Ω–∏–∏</option>
        <option value="groups">–ì—Ä—É–ø–ø—ã</option>
        <option value="ads">–û–±—ä—è–≤–ª–µ–Ω–∏—è</option>
      </select>
      <input id="vk-release" placeholder="release_id (–∞–≤—Ç–æ)" readonly />
      <input id="vk-community" placeholder="community_id (–≤—ã–±–µ—Ä–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –≤—ã—à–µ)" />
      <input type="file" id="vk-file" accept=".xlsx" />
      <button id="btn-upload-vk" type="button">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
    </div>
    <pre id="vk-out">‚Äî</pre>
  </div>

  <div class="card">
    <h3 style="margin-top:0">E) –î–µ–º–æ–≥—Ä–∞—Ñ–∏—è / –ì–µ–æ</h3>
    <div class="row">
      <select id="dg-kind">
        <option value="demo">–î–µ–º–æ–≥—Ä–∞—Ñ–∏—è</option>
        <option value="countries">–°—Ç—Ä–∞–Ω—ã</option>
        <option value="cities">–ì–æ—Ä–æ–¥–∞</option>
      </select>
      <input id="dg-release" placeholder="release_id (–∞–≤—Ç–æ)" readonly />
      <input id="dg-community" placeholder="community_id (–≤—ã–±–µ—Ä–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –≤—ã—à–µ)" />
      <input type="file" id="dg-file" accept=".xlsx" />
      <button id="btn-upload-dg" type="button">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
    </div>
    <pre id="dg-out">‚Äî</pre>
  </div>
</div>

<div class="card">
  <h3 style="margin-top:0">F) –°—Ç—Ä–∏–º—ã (–Ω–∞ –≤–µ—Å—å —Ä–µ–ª–∏–∑)</h3>
  <div class="row">
    <input id="s-release" placeholder="release_id (–∞–≤—Ç–æ)" readonly />
    <input type="file" id="s-file" accept=".xlsx" />
    <button id="btn-upload-streams" type="button">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
  </div>
  <pre id="s-out">‚Äî</pre>
</div>

<script>
/** ---------- Bind UI ---------- */
$('btn-refresh').addEventListener('click', refresh);
$('release-select').addEventListener('change', onSelectRelease);
$('btn-create-release').addEventListener('click', createRelease);
$('btn-add-community').addEventListener('click', addCommunity);
$('btn-publish').addEventListener('click', togglePublish);

$('btn-upload-vk').addEventListener('click', uploadVk);
$('btn-upload-dg').addEventListener('click', uploadDemoGeo);
$('btn-upload-streams').addEventListener('click', uploadStreams);

/** ---------- Init ---------- */
refresh();
</script>

</body>
</html>
